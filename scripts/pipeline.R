# set your work dir
set.wd("your/path/")

# step 1: calculate scores from scib output
scib_bm_table <- read.csv("data/scib_metrics_output.csv", row.names = 1)
scib_bm_table <- t(scib_bm_table) %>% as.data.frame()

# preview
#                                  CCA    Harmony       scVI     scANVI     Combat  Scanorama    FastMNN MIRA_feature MIRA_topic      BBKNN   CellHint
# NMI_cluster/label         0.68113424 0.40519090 0.70671790 0.78339236 0.67791204 0.07367235 0.70544284   0.64829393  0.6195890 0.63326321 0.63792718
# ARI_cluster/label         0.42592147 0.18460916 0.45410402 0.60476635 0.44332553 0.01662426 0.45040404   0.38200270  0.3622267 0.38102480 0.37931134
# ASW_label                 0.52110099 0.39779555 0.53132162 0.57205420 0.50618038 0.45541007 0.54055252   0.47874877  0.4217216 0.55051497 0.55051497
# ASW_label/batch           0.76473195 0.74994410 0.81212279 0.81441418 0.87448696 0.76810873 0.81290315   0.63291911  0.4328971 0.83497916 0.83497916
# PCR_batch                 0.59717657 0.98060867 0.72960228 0.65156498 0.97685082 0.36158519 0.58487625   0.31726962  0.2983176 0.39905948 0.39905948
# cell_cycle_conservation   0.52890935 0.62995832 0.64323095 0.60428295 0.45395620 0.33703927 0.48226669   0.41737277  0.3747284 0.72444419 0.72444419
# isolated_label_F1         0.07960199 0.09638554 0.07729469 0.07881773 0.18750000 0.02777778 0.08080808   0.06698565  0.1750000 0.08121827 0.08121827
# isolated_label_silhouette 0.68413717 0.71319951 0.75965893 0.75051224 0.66156498 0.47277215 0.75466657   0.61397110  0.6961596 0.69666968 0.69666968
# graph_conn                0.91086152 0.69119826 0.94227532 0.94778690 0.90399530 0.08817273 0.92683494   0.73696937  0.5444755 0.99941979 0.99987096
# kBET                      0.83627548 0.69261077 0.79482423 0.79398228 0.66163020 0.03976692 0.82879844   0.75732297  0.6348482 0.74590008 0.74406771
# iLISI                     0.11064468 0.13437375 0.09931888 0.09130411 0.08422109 0.08968606 0.09891523   0.10286301  0.1113102 0.50229592 0.44128234
# cLISI                     0.98150708 0.94894612 0.98188344 0.99171863 0.97944120 0.87262356 0.98292546   0.97101663  0.9679921 0.81405685 0.90387700
# hvg_overlap                       NA         NA         NA         NA         NA         NA         NA           NA         NA         NA         NA
# trajectory                        NA         NA         NA         NA         NA         NA         NA           NA         NA         NA         NA


scib_scores <- scib_calculate_scores(scib_bm_table)
